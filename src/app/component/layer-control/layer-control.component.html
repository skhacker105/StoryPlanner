
<div class="movie-control-container" *ngIf="movieService.movie">

    <div class="action-buttons">
        <button mat-icon-button color="primary">
            <mat-icon>shutter_speed_add</mat-icon>
        </button>
        <div class="time">
            <pre class="time-display">{{ timelineService.currentTime.value | spacePadded:4 }}</pre>
        </div>

        <div class="spacer"></div>
        
        <!-- Download -->
        <button mat-icon-button color="primary">
            <mat-icon>download_2</mat-icon>
        </button>

        <!-- Upload -->
        <button mat-icon-button color="primary">
            <mat-icon>upload_2</mat-icon>
        </button>
    </div>

    <div class="movie-time-layers" *ngIf="movieService.movie.timeline[currentTime]" cdkDropList (cdkDropListDropped)="drop($event)">
        <mat-divider></mat-divider>

        <div class="place-holder-layer" *cdkDragPlaceholder></div>
        
        @for (layer of movieService.movie.timeline[currentTime].layers; track layer;) {
            <app-layer-display cdkDrag [layer]="layer" [isSelected]="compareSelectedLayer(layer)"
            [layerMember]="movieService.dictionaryMemberBook[layer.memberId].member" 
            [layerOption]="movieService.dictionaryMemberBook[layer.memberId].options[layer.memberOptionId]"
            (onCLick)="handleLayerClick(layer)" (onDelete)="handleDeleteConfirmationPopup(layer)">
            </app-layer-display>
        }
    </div>

    <div class="layer-option" *ngIf="selectedLayer">
        <app-popup-header [title]="'Layer ' + selectedLayer.stackPosition" (onCloseTrigger)="resetSelectedLayer()">
        </app-popup-header>
        <div class="layer-list-container">
            <app-layer-properties [layer]="selectedLayer"
            [layerMember]="movieService.dictionaryMemberBook[selectedLayer.memberId].member" 
            [layerOption]="movieService.dictionaryMemberBook[selectedLayer.memberId].options[selectedLayer.memberOptionId]"
            (onCancel)="resetSelectedLayer()"
            (onSave)="handleUpdateLayer($event)">
            </app-layer-properties>
        </div>
    </div>
</div>